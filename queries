
-- Question: Which year saw the highest and lowest number of countries participating?
-- Step 1: Count distinct countries per Olympic year
WITH country_participation AS (
    SELECT
        year,
        COUNT(DISTINCT noc) AS num_countries
    FROM athlete_events
    GROUP BY year
)
-- Step 2: Select min and max
SELECT TOP 1 year, num_countries
FROM country_participation
ORDER BY num_countries ASC;  -- lowest

SELECT TOP 1 year, num_countries
FROM country_participation
ORDER BY num_countries DESC; -- highest

-- ===========================================
-- OLYMPICS SQL ANALYSIS PROJECT
-- ===========================================
-- This file contains questions and answers in SQL
-- Dataset: athlete_events + noc_regions 
-- ===========================================


-- Q1: How many Olympic Games have been held?

SELECT COUNT(DISTINCT games) AS Total_Olympics
FROM athlete_events;


-- Q2: List down all Olympic Games held so far.
-- Each unique (year, season, city) is one Olympic edition.
SELECT DISTINCT year, season, city
FROM athlete_events
ORDER BY year;


-- Q3: Mention the total no. of nations that participated in each Olympic game?

SELECT games, COUNT(DISTINCT team) AS Total_no_of_Nations
FROM athlete_events
GROUP BY games
ORDER BY games


-- Q4: Which year saw the highest and lowest no of countries participating in Olympics?

SELECT TOP 1 games, COUNT(DISTINCT noc) AS total_nations
FROM athlete_events
GROUP BY games
ORDER BY total_nations DESC;

SELECT TOP 1 games, COUNT(DISTINCT noc) AS total_nations
FROM athlete_events
GROUP BY games
ORDER BY total_nations ASC;


-- Q5: Which nation has participated in all of the Olympic games?

SELECT noc, COUNT(DISTINCT games) AS games_participated
FROM athlete_events
GROUP BY noc
HAVING COUNT(DISTINCT games) = (SELECT COUNT(DISTINCT games) FROM athlete_events);


-- Q6: Identify the sport which was played in all Summer Olympics.
SELECT sport
FROM athlete_events
WHERE season = 'Summer'
GROUP BY sport
HAVING COUNT(DISTINCT games) = (
    SELECT COUNT(DISTINCT games) FROM athlete_events WHERE season = 'Summer');


-- Q7: Which Sports were played only once in the Olympics?

SELECT sport, COUNT(DISTINCT games) AS no_of_games
FROM athlete_events
GROUP BY sport
HAVING COUNT(DISTINCT games) = 1;

-- Q8: Fetch the total no of sports played in each Olympic games.

SELECT games, COUNT(DISTINCT sport) AS Total_sports
FROM athlete_events
GROUP BY games
ORDER BY games;


-- Q9: Fetch details of the oldest athletes to win a gold medal.

SELECT name, sex, age, team, games, sport, event, medal
FROM athlete_events
WHERE medal = 'GOLD'
    AND age = (SELECT MAX(age) FROM athlete_events WHERE medal = 'Gold');


-- Q10: Find the ratio of male and female athletes who participated in all Olympic Games.
-- Step 1: Count distinct athletes by gender (using "id" as unique athlete identifier).
-- Step 2: Calculate ratio (M/F) and percentages for clarity.






-- ===========================================
-- OLYMPICS SQL ANALYSIS PROJECT
-- ===========================================
-- This file contains questions and answers in SQL
-- Dataset: athlete_events + noc_regions 
-- ===========================================


-- Q1: How many Olympic Games have been held?

SELECT COUNT(DISTINCT games) AS Total_Olympics
FROM athlete_events;


-- Q2: List down all Olympic Games held so far.
-- Each unique (year, season, city) is one Olympic edition.
SELECT DISTINCT year, season, city
FROM athlete_events
ORDER BY year;


-- Q3: Mention the total no. of nations that participated in each Olympic game?

SELECT games, COUNT(DISTINCT team) AS Total_no_of_Nations
FROM athlete_events
GROUP BY games
ORDER BY games


-- Q4: Which year saw the highest and lowest no of countries participating in Olympics?

SELECT TOP 1 games, COUNT(DISTINCT noc) AS total_nations
FROM athlete_events
GROUP BY games
ORDER BY total_nations DESC;

SELECT TOP 1 games, COUNT(DISTINCT noc) AS total_nations
FROM athlete_events
GROUP BY games
ORDER BY total_nations ASC;


-- Q5: Which nation has participated in all of the Olympic games?

SELECT noc, COUNT(DISTINCT games) AS games_participated
FROM athlete_events
GROUP BY noc
HAVING COUNT(DISTINCT games) = (SELECT COUNT(DISTINCT games) FROM athlete_events);


-- Q6: Identify the sport which was played in all Summer Olympics.
SELECT sport
FROM athlete_events
WHERE season = 'Summer'
GROUP BY sport
HAVING COUNT(DISTINCT games) = (
    SELECT COUNT(DISTINCT games) FROM athlete_events WHERE season = 'Summer'
);
